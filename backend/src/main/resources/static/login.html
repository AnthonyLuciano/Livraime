<!-- Salve como login-teste.html e abra no navegador -->
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Teste Login Livraime</title>
</head>
<body>
    <h2>Cadastro</h2>
    <form id="cadastroForm">
        Nome: <input type="text" id="nome"><br>
        Email: <input type="email" id="email"><br>
        Senha: <input type="password" id="senha"><br>
        <button type="submit">Cadastrar</button>
    </form>
    <div id="cadastroMsg"></div>

    <h2>Login</h2>
    <form id="loginForm">
        Email: <input type="email" id="loginEmail"><br>
        Senha: <input type="password" id="loginSenha"><br>
        <button type="submit">Entrar</button>
    </form>
    <div id="loginMsg"></div>

    <h2>Confirmar E-mail</h2>
    <form id="confirmarForm">
        Email: <input type="email" id="confEmail"><br>
        Código: <input type="text" id="confCodigo"><br>
        <button type="submit">Confirmar</button>
    </form>
    <div id="confMsg"></div>

    <h2>Reenviar Código</h2>
    <form id="reenviarForm">
        Email: <input type="email" id="reenviarEmail"><br>
        <button type="submit">Reenviar</button>
    </form>
    <div id="reenviarMsg"></div>

<script>
const api = "/api/auth";

document.getElementById("cadastroForm").onsubmit = async function(e) {
    e.preventDefault();
    const resp = await fetch(api + "/cadastro", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({
            nome: document.getElementById("nome").value,
            email: document.getElementById("email").value,
            senha: document.getElementById("senha").value
        })
    });
    document.getElementById("cadastroMsg").innerText = await resp.text();
};

document.getElementById("loginForm").onsubmit = async function(e) {
    e.preventDefault();
    const loginData = {
        email: document.getElementById("loginEmail").value,
        senha: document.getElementById("loginSenha").value
    };
    const resp = await fetch(api + "/login", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify(loginData)
    });
    document.getElementById("loginMsg").innerText = await resp.text();
};

document.getElementById("confirmarForm").onsubmit = async function(e) {
    e.preventDefault();
    const params = new URLSearchParams();
    params.append("email", document.getElementById("confEmail").value);
    params.append("codigo", document.getElementById("confCodigo").value);
    const resp = await fetch(api + "/confirmar-email?" + params, { 
        method: "POST" 
    });
    document.getElementById("confMsg").innerText = await resp.text();
};

document.getElementById("reenviarForm").onsubmit = async function(e) {
    e.preventDefault();
    const reenviarData = {
        email: document.getElementById("reenviarEmail").value
    };
    const resp = await fetch(api + "/reenviar-codigo", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify(reenviarData)
    });
    document.getElementById("reenviarMsg").innerText = await resp.text();
};
</script>
</body>
</html>